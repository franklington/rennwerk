!function(t,i,e){"use strict";t.masongram=e.fn.masongram=function(t){return this.each(function(){var i=new a(this,t);return new n(i,t.lightbox),i})};var n=function(){function n(t,i){this.album=[],this.currentImageIndex=void 0,this.init(),this.masonSetup(t),this.options=e.extend({},this.constructor.defaults),this.option(i)}var a;return n.defaults={albumLabel:"Image %1 of %2",alwaysShowNavOnTouchDevices:!1,fadeDuration:600,fitImagesInViewport:!0,imageFadeDuration:600,positionFromTop:50,resizeDuration:700,showImageNumberLabel:!0,wrapAround:!1,disableScrolling:!1,sanitizeTitle:!1},n.prototype.option=function(t){e.extend(this.options,t)},n.prototype.masonSetup=function(t){a=t;var i=this;a.on("newitems",function(){i.loadInifinite()})},n.prototype.imageCountLabel=function(t,i){return this.options.albumLabel.replace(/%1/g,t).replace(/%2/g,i)},n.prototype.init=function(){var t=this;e(i).ready(function(){t.enable(),t.build()})},n.prototype.enable=function(){var t=this;e("body").on("click","a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox]",function(i){return t.previousLinkElement=e(i.currentTarget),t.start(e(i.currentTarget)),!1})},n.prototype.build=function(){if(!(e("#lightbox").length>0)){var t=this;e('<div id="lightboxOverlay" class="lightboxOverlay"></div><div id="lightbox" class="lightbox"><div class="lb-outerContainer"><div class="lb-container"><img class="lb-image" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" /><div class="lb-nav"><a class="lb-prev" href="" ></a><a class="lb-next" href="" ></a></div><div class="lb-loader"><a class="lb-cancel"></a></div></div></div><div class="lb-dataContainer"><div class="lb-data"><div class="lb-details"><span class="lb-caption"></span><span class="lb-number"></span></div><div class="lb-closeContainer"><a class="lb-close"></a></div></div></div></div>').appendTo(e("body")),this.$lightbox=e("#lightbox"),this.$overlay=e("#lightboxOverlay"),this.$outerContainer=this.$lightbox.find(".lb-outerContainer"),this.$container=this.$lightbox.find(".lb-container"),this.$image=this.$lightbox.find(".lb-image"),this.$nav=this.$lightbox.find(".lb-nav"),this.containerPadding={top:parseInt(this.$container.css("padding-top"),10),right:parseInt(this.$container.css("padding-right"),10),bottom:parseInt(this.$container.css("padding-bottom"),10),left:parseInt(this.$container.css("padding-left"),10)},this.imageBorderWidth={top:parseInt(this.$image.css("border-top-width"),10),right:parseInt(this.$image.css("border-right-width"),10),bottom:parseInt(this.$image.css("border-bottom-width"),10),left:parseInt(this.$image.css("border-left-width"),10)},this.$overlay.hide().on("click",function(){return t.end(),!1}),this.$lightbox.hide().on("click",function(i){return"lightbox"===e(i.target).attr("id")&&t.end(),!1}),this.$outerContainer.on("click",function(i){return"lightbox"===e(i.target).attr("id")&&t.end(),!1}),this.$lightbox.find(".lb-prev").on("click",function(){return 0===t.currentImageIndex?t.changeImage(t.album.length-1):t.changeImage(t.currentImageIndex-1),!1}),this.$lightbox.find(".lb-next").on("click",function(){return t.currentImageIndex===t.album.length-1?t.changeImage(0):t.changeImage(t.currentImageIndex+1),!1}),this.$nav.on("mousedown",function(i){3===i.which&&(t.$nav.css("pointer-events","none"),t.$lightbox.one("contextmenu",function(){setTimeout(function(){this.$nav.css("pointer-events","auto")}.bind(t),0)}))}),this.$lightbox.find(".lb-loader, .lb-close").on("click",function(){return t.end(),!1})}},n.prototype.start=function(i){function n(t){a.album.push({alt:t.attr("data-alt"),link:t.attr("href"),title:t.attr("data-title")||t.attr("title")})}var a=this,o=e(t);o.on("resize",e.proxy(this.sizeOverlay,this)),e("select, object, embed").css({visibility:"hidden"}),this.sizeOverlay(),this.album=[];var r,s=0,l=i.attr("data-lightbox");if(l){r=e(i.prop("tagName")+'[data-lightbox="'+l+'"]');for(var h=0;h<r.length;h=++h)n(e(r[h])),r[h]===i[0]&&(s=h)}else if("lightbox"===i.attr("rel"))n(i);else{r=e(i.prop("tagName")+'[rel="'+i.attr("rel")+'"]');for(var d=0;d<r.length;d=++d)n(e(r[d])),r[d]===i[0]&&(s=d)}var c=o.scrollTop()+this.options.positionFromTop,g=o.scrollLeft();this.$lightbox.css({top:c+"px",left:g+"px"}).fadeIn(this.options.fadeDuration),this.options.disableScrolling&&e("html").addClass("lb-disable-scrolling"),this.changeImage(s)},n.prototype.changeImage=function(i){var n=this;this.disableKeyboardNav();var a=this.$lightbox.find(".lb-image");this.$overlay.fadeIn(this.options.fadeDuration),e(".lb-loader").fadeIn("slow"),this.$lightbox.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide(),this.$outerContainer.addClass("animating");var o=new Image;o.onload=function(){var r,s,l,h,d,c;a.attr({alt:n.album[i].alt,src:n.album[i].link}),e(o),a.width(o.width),a.height(o.height),n.options.fitImagesInViewport&&(c=e(t).width(),d=e(t).height(),h=c-n.containerPadding.left-n.containerPadding.right-n.imageBorderWidth.left-n.imageBorderWidth.right-20,l=d-n.containerPadding.top-n.containerPadding.bottom-n.imageBorderWidth.top-n.imageBorderWidth.bottom-120,n.options.maxWidth&&n.options.maxWidth<h&&(h=n.options.maxWidth),n.options.maxHeight&&n.options.maxHeight<h&&(l=n.options.maxHeight),(o.width>h||o.height>l)&&(o.width/h>o.height/l?(s=h,r=parseInt(o.height/(o.width/s),10),a.width(s),a.height(r)):(r=l,s=parseInt(o.width/(o.height/r),10),a.width(s),a.height(r)))),n.sizeContainer(a.width(),a.height())},o.src=this.album[i].link,this.currentImageIndex=i},n.prototype.sizeOverlay=function(){this.$overlay.width(e(i).width()).height(e(i).height())},n.prototype.sizeContainer=function(t,i){function e(){n.$lightbox.find(".lb-dataContainer").width(r),n.$lightbox.find(".lb-prevLink").height(s),n.$lightbox.find(".lb-nextLink").height(s),n.showImage()}var n=this,a=this.$outerContainer.outerWidth(),o=this.$outerContainer.outerHeight(),r=t+this.containerPadding.left+this.containerPadding.right+this.imageBorderWidth.left+this.imageBorderWidth.right,s=i+this.containerPadding.top+this.containerPadding.bottom+this.imageBorderWidth.top+this.imageBorderWidth.bottom;a!==r||o!==s?this.$outerContainer.animate({width:r,height:s},this.options.resizeDuration,"swing",function(){e()}):e()},n.prototype.showImage=function(){this.$lightbox.find(".lb-loader").stop(!0).hide(),this.$lightbox.find(".lb-image").fadeIn(this.options.imageFadeDuration),this.updateNav(),this.updateDetails(),this.preloadNeighboringImages(),this.enableKeyboardNav()},n.prototype.updateNav=function(){var t=!1;try{i.createEvent("TouchEvent"),t=!!this.options.alwaysShowNavOnTouchDevices}catch(t){}this.$lightbox.find(".lb-nav").show(),this.album.length>1&&(this.options.wrapAround?(t&&this.$lightbox.find(".lb-prev, .lb-next").css("opacity","1"),this.$lightbox.find(".lb-prev, .lb-next").show()):(this.currentImageIndex>0&&(this.$lightbox.find(".lb-prev").show(),t&&this.$lightbox.find(".lb-prev").css("opacity","1")),this.currentImageIndex<this.album.length-1&&(this.$lightbox.find(".lb-next").show(),t&&this.$lightbox.find(".lb-next").css("opacity","1"))))},n.prototype.updateDetails=function(){var i=this;if(void 0!==this.album[this.currentImageIndex].title&&""!==this.album[this.currentImageIndex].title){var n=this.$lightbox.find(".lb-caption");this.options.sanitizeTitle?n.text(this.album[this.currentImageIndex].title):n.html(this.album[this.currentImageIndex].title),n.fadeIn("fast").find("a").on("click",function(i){void 0!==e(this).attr("target")?t.open(e(this).attr("href"),e(this).attr("target")):location.href=e(this).attr("href")})}if(this.album.length>1&&this.options.showImageNumberLabel){var a=this.imageCountLabel(this.currentImageIndex+1,this.album.length);this.$lightbox.find(".lb-number").text(a).fadeIn("fast")}else this.$lightbox.find(".lb-number").hide();this.$outerContainer.removeClass("animating"),this.$lightbox.find(".lb-dataContainer").fadeIn(this.options.resizeDuration,function(){return i.sizeOverlay()})},n.prototype.preloadNeighboringImages=function(){if(this.album.length>this.currentImageIndex+1){(new Image).src=this.album[this.currentImageIndex+1].link}if(this.currentImageIndex>0){(new Image).src=this.album[this.currentImageIndex-1].link}this.album.length==this.currentImageIndex+3&&a.load()},n.prototype.enableKeyboardNav=function(){e(i).on("keyup.keyboard",e.proxy(this.keyboardAction,this))},n.prototype.disableKeyboardNav=function(){e(i).off(".keyboard")},n.prototype.keyboardAction=function(t){var i=t.keyCode,e=String.fromCharCode(i).toLowerCase();27===i||e.match(/x|o|c/)?this.end():"p"===e||37===i?0!==this.currentImageIndex?this.changeImage(this.currentImageIndex-1):this.options.wrapAround&&this.album.length>1&&this.changeImage(this.album.length-1):"n"!==e&&39!==i||(this.currentImageIndex!==this.album.length-1?this.changeImage(this.currentImageIndex+1):this.options.wrapAround&&this.album.length>1&&this.changeImage(0))},n.prototype.loadInifinite=function(){var t=this;this.album=[];var i;i=e('a[data-lightbox="feed"]');for(var n=0;n<i.length;n=++n)!function(i){t.album.push({alt:i.attr("data-alt"),link:i.attr("href"),title:i.attr("data-title")||i.attr("title")})}(e(i[n]));this.updateNav()},n.prototype.end=function(){this.disableKeyboardNav(),e(t).off("resize",this.sizeOverlay),this.$lightbox.fadeOut(this.options.fadeDuration),this.$overlay.fadeOut(this.options.fadeDuration),e("select, object, embed").css({visibility:"visible"}),this.options.disableScrolling&&e("html").removeClass("lb-disable-scrolling")},n}(),a=function(){function n(t,i){var e=this;d.forEach(function(t){e.require(t)}),c||(this.configure(i),this.setup(t))}var a,s,l,h,d=["jQuery","Masonry"],c=!1;return n.prototype={require:function(i){var e=void 0!==t[i];return e||(c=!0,console.error("Dependency unavailable: "+i)),e},configure:function(t){a=e.extend(!0,{endpoint:"users/self",loop:!1,count:10,offset:10,size:"low_resolution",caption:"{caption}",location:"inherit&caption",footer:"#wrapper-footer"},t)},setup:function(n){var r=this;s=e("<div>").attr({class:"masongram-container"}).appendTo(n),e("<div>").attr({class:"masongram-image-sizer masongram-image-size-"+a.size}).appendTo(s),s.masonry({itemSelector:".masongram-image-container",columnWidth:".masongram-image-sizer",percentPosition:!0}),l=new o(a),l.on("loaded",function(t){r.append(t)});var h;e(t).scroll(function(){h||(h=setTimeout(function(){s.imagesLoaded().progress(function(){(e(t).scrollTop()||e("body").scrollTop())>e(i).height()-(e(t).height()*(1+a.offset/100)+e(a.footer).height())&&r.load()}),h=null},100))}),s.on("layoutComplete",function(){s.imagesLoaded().progress(function(){e("body").height()<e(t).height()&&r.load()})}),r.load()},load:function(){h||(h=!0,l.load())},on:function(t,i){e(this).on(t,function(t,e){i(e)})},append:function(i){var n=this;i.forEach(function(o,l){var d=new r(o,{caption:a.caption,size:a.size,location:a.location}),c=d.getObject();setTimeout(function(){c.imagesLoaded().progress(function(){s.append(c).masonry("appended",c),l+1===i.length&&(h=!1,e(n).trigger("newitems"),e(t).trigger("scroll"))})},200*l)})}},n}(),o=function(){function t(t){i=t,n="https://api.instagram.com/v1/"+i.endpoint+"/media/recent/"}var i,n;return t.prototype={load:function(){if(n){var t=this,a=e.Deferred();return e.ajax({type:"POST",url:n,data:{access_token:i.access_token,count:i.count},dataType:"jsonp"}).success(function(o){e(t).trigger("loaded",[o.data]),a.resolve(o.data),i.loop||(n=!(!o.pagination||!o.pagination.next_url)&&o.pagination.next_url)}).error(function(){a.reject("Error fetching data")}),a.promise()}},on:function(t,i){e(this).on(t,function(t,e){i(e)})}},t}(),r=function(){function t(t,i){n=t,a=i,this.parseLocation(),this.create()}var i,n,a;return t.prototype={create:function(){i=e("<div>").attr({tabindex:0,class:"masongram-image-container masongram-image-size-"+a.size}),e("<a>").attr({href:n.images[a.size].url,"data-lightbox":"feed","data-title":this.parseCaption()}).appendTo(i),e("<img>").attr({src:n.images[a.size].url,width:n.images[a.size].width,height:n.images[a.size].height,class:"masongram-image"}).appendTo(i);var t=e("<div>",{class:"masongram-image-caption-container"}),o=e("<div>",{class:"masongram-image-caption"});n.caption&&n.caption.text&&o.html(this.parseCaption()),o.appendTo(t),t.appendTo(i)},getObject:function(){return i},parseLocation:function(){if(-1===a.location.indexOf("inherit")&&delete n.location,-1!==a.location.indexOf("caption")&&n.caption&&n.caption.text&&/@[\d]+\.[\d]+,[\d]+\.[\d]+/.test(n.caption.text)){var t=n.caption.text.match(/@([\d]+\.[\d]+),([\d]+\.[\d]+)/);n.caption.text=n.caption.text.replace(/\s*@([\d]+\.[\d]+),([\d]+\.[\d]+)/,""),n.location={latitude:t[1],longitude:t[2]}}},parseCaption:function(){var t=a.caption;if(/{.*}/.test(t)){t.match(/{([^}]+)}/g).forEach(function(i){switch(i){case"{location}":t=t.replace(i,n.location&&void 0!==n.location.latitude&&void 0!==n.location.longitude?n.location.latitude+","+n.location.longitude:"NO_DATA");break;case"{latitude}":t=t.replace(i,n.location&&void 0!==n.location.latitude?n.location.latitude:"NO_DATA");break;case"{longitude}":t=t.replace(i,n.location&&void 0!==n.location.longitude?n.location.longitude:"NO_DATA");break;case"{caption}":t=t.replace(i,n.caption&&void 0!==n.caption.text?n.caption.text:"NO_DATA");break;case"{likes}":t=t.replace(i,n.likes&&void 0!==n.likes.count?n.likes.count:"NO_DATA");break;case"{link}":t=t.replace(i,n.link?n.link:"NO_DATA")}})}return t}},t}()}(window,document,jQuery);
//# sourceMappingURL=masongram.min.js.map
